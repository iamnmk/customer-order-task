<div class="orders-container">
  <!-- Header Section -->
  <div class="page-header">
    <div class="header-content">
      <div class="header-top">
        <button class="back-button" [routerLink]="['/customers']">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M17 10a.75.75 0 01-.75.75H5.612l4.158 3.96a.75.75 0 11-1.04 1.08l-5.5-5.25a.75.75 0 010-1.08l5.5-5.25a.75.75 0 111.04 1.08L5.612 9.25H16.25A.75.75 0 0117 10z" clip-rule="evenodd" />
          </svg>
          Back to Customers
        </button>
        
        <div class="header-right">
          <!-- Auto-Update Toggle -->
          <div class="auto-update-toggle">
            <label class="toggle-label">
              <span class="toggle-text">Auto-Update</span>
              <div class="toggle-switch" (click)="toggleAutoUpdate()">
                <span class="toggle-slider" [class.active]="autoUpdateEnabled"></span>
              </div>
            </label>
          </div>

          <!-- Real-time connection indicator -->
          <div class="connection-status" [class.connected]="isRealtimeConnected" [class.disconnected]="!isRealtimeConnected">
            <span class="status-dot"></span>
            <span class="status-text">{{ isRealtimeConnected ? 'Live' : 'Offline' }}</span>
          </div>
        </div>
      </div>
      
      <div class="customer-header" *ngIf="customer">
        <div class="customer-avatar-large">
          {{ customer.name.charAt(0).toUpperCase() }}
        </div>
        <div class="customer-details">
          <h1 class="page-title">{{ customer.name }}'s Orders</h1>
          <p class="page-subtitle">{{ customer.email }}</p>
          <div class="customer-badges">
            <span class="badge" [class.badge-active]="customer.isActive" [class.badge-inactive]="!customer.isActive">
              {{ customer.isActive ? 'Active' : 'Inactive' }}
            </span>
            <span class="badge badge-orders">{{ totalCount }} Total Orders</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Filters Panel -->
  <div class="filters-section">
    <div class="filters-header">
      <button class="filters-toggle" (click)="toggleFilters()">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M2.628 1.601C5.028 1.206 7.49 1 10 1s4.973.206 7.372.601a.75.75 0 01.628.74v2.288a2.25 2.25 0 01-.659 1.59l-4.682 4.683a2.25 2.25 0 00-.659 1.59v3.037c0 .684-.31 1.33-.844 1.757l-1.937 1.55A.75.75 0 018 18.25v-5.757a2.25 2.25 0 00-.659-1.591L2.659 6.22A2.25 2.25 0 012 4.629V2.34a.75.75 0 01.628-.74z" clip-rule="evenodd" />
        </svg>
        <span>Filters</span>
        <span *ngIf="hasActiveFilters" class="active-badge">{{ 
          (filters.fromDate ? 1 : 0) + 
          (filters.toDate ? 1 : 0) + 
          (filters.minAmount !== null ? 1 : 0) + 
          (filters.maxAmount !== null ? 1 : 0) 
        }} active</span>
        <svg class="chevron" [class.rotated]="showFilters" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
          <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd" />
        </svg>
      </button>
    </div>

    <div class="filters-panel" [class.show]="showFilters">
      <div class="filters-grid">
        <!-- Date Range -->
        <div class="filter-group">
          <label class="filter-label">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M5.75 2a.75.75 0 01.75.75V4h7V2.75a.75.75 0 011.5 0V4h.25A2.75 2.75 0 0118 6.75v8.5A2.75 2.75 0 0115.25 18H4.75A2.75 2.75 0 012 15.25v-8.5A2.75 2.75 0 014.75 4H5V2.75A.75.75 0 015.75 2zm-1 5.5c-.69 0-1.25.56-1.25 1.25v6.5c0 .69.56 1.25 1.25 1.25h10.5c.69 0 1.25-.56 1.25-1.25v-6.5c0-.69-.56-1.25-1.25-1.25H4.75z" clip-rule="evenodd" />
            </svg>
            From Date
          </label>
          <input 
            type="date" 
            class="filter-input" 
            [(ngModel)]="filters.fromDate"
            placeholder="Start date"
          />
        </div>

        <div class="filter-group">
          <label class="filter-label">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M5.75 2a.75.75 0 01.75.75V4h7V2.75a.75.75 0 011.5 0V4h.25A2.75 2.75 0 0118 6.75v8.5A2.75 2.75 0 0115.25 18H4.75A2.75 2.75 0 012 15.25v-8.5A2.75 2.75 0 014.75 4H5V2.75A.75.75 0 015.75 2zm-1 5.5c-.69 0-1.25.56-1.25 1.25v6.5c0 .69.56 1.25 1.25 1.25h10.5c.69 0 1.25-.56 1.25-1.25v-6.5c0-.69-.56-1.25-1.25-1.25H4.75z" clip-rule="evenodd" />
            </svg>
            To Date
          </label>
          <input 
            type="date" 
            class="filter-input" 
            [(ngModel)]="filters.toDate"
            placeholder="End date"
          />
        </div>

        <!-- Amount Range -->
        <div class="filter-group">
          <label class="filter-label">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
              <path d="M10.75 10.818v2.614A3.13 3.13 0 0011.888 13c.482-.315.612-.648.612-.875 0-.227-.13-.56-.612-.875a3.13 3.13 0 00-1.138-.432zM8.33 8.62c.053.055.115.11.184.164.208.16.46.284.736.363V6.603a2.45 2.45 0 00-.35.13c-.14.065-.27.143-.386.233-.377.292-.514.627-.514.909 0 .184.058.39.202.592.037.051.08.102.128.152z" />
              <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-6a.75.75 0 01.75.75v.316a3.78 3.78 0 011.653.713c.426.33.744.74.925 1.2a.75.75 0 01-1.395.55 1.35 1.35 0 00-.447-.563 2.187 2.187 0 00-.736-.363V9.3c.698.093 1.383.32 1.959.696.787.514 1.29 1.27 1.29 2.13 0 .86-.504 1.616-1.29 2.13-.576.377-1.261.603-1.96.696v.299a.75.75 0 11-1.5 0v-.3c-.697-.092-1.382-.318-1.958-.695-.482-.315-.857-.717-1.078-1.188a.75.75 0 111.359-.636c.08.173.245.376.54.569.313.205.706.353 1.138.432v-2.748a3.782 3.782 0 01-1.653-.713C6.9 9.433 6.5 8.681 6.5 7.875c0-.805.4-1.558 1.097-2.096a3.78 3.78 0 011.653-.713V4.75A.75.75 0 0110 4z" clip-rule="evenodd" />
            </svg>
            Min Amount ($)
          </label>
          <input 
            type="number" 
            class="filter-input" 
            [(ngModel)]="filters.minAmount"
            placeholder="0.00"
            step="0.01"
            min="0"
          />
        </div>

        <div class="filter-group">
          <label class="filter-label">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
              <path d="M10.75 10.818v2.614A3.13 3.13 0 0011.888 13c.482-.315.612-.648.612-.875 0-.227-.13-.56-.612-.875a3.13 3.13 0 00-1.138-.432zM8.33 8.62c.053.055.115.11.184.164.208.16.46.284.736.363V6.603a2.45 2.45 0 00-.35.13c-.14.065-.27.143-.386.233-.377.292-.514.627-.514.909 0 .184.058.39.202.592.037.051.08.102.128.152z" />
              <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-6a.75.75 0 01.75.75v.316a3.78 3.78 0 011.653.713c.426.33.744.74.925 1.2a.75.75 0 01-1.395.55 1.35 1.35 0 00-.447-.563 2.187 2.187 0 00-.736-.363V9.3c.698.093 1.383.32 1.959.696.787.514 1.29 1.27 1.29 2.13 0 .86-.504 1.616-1.29 2.13-.576.377-1.261.603-1.96.696v.299a.75.75 0 11-1.5 0v-.3c-.697-.092-1.382-.318-1.958-.695-.482-.315-.857-.717-1.078-1.188a.75.75 0 111.359-.636c.08.173.245.376.54.569.313.205.706.353 1.138.432v-2.748a3.782 3.782 0 01-1.653-.713C6.9 9.433 6.5 8.681 6.5 7.875c0-.805.4-1.558 1.097-2.096a3.78 3.78 0 011.653-.713V4.75A.75.75 0 0110 4z" clip-rule="evenodd" />
            </svg>
            Max Amount ($)
          </label>
          <input 
            type="number" 
            class="filter-input" 
            [(ngModel)]="filters.maxAmount"
            placeholder="Any"
            step="0.01"
            min="0"
          />
        </div>
      </div>

      <!-- Filter Actions -->
      <div class="filter-actions">
        <button class="btn btn-primary" (click)="applyFilters()">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" />
          </svg>
          Apply Filters
        </button>
        <button class="btn btn-secondary" (click)="clearFilters()" [disabled]="!hasActiveFilters">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
            <path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z" />
          </svg>
          Clear All
        </button>
      </div>
    </div>
  </div>

  <!-- Error Alert -->
  <div *ngIf="error" class="alert alert-error">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
      <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.28 7.22a.75.75 0 00-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 101.06 1.06L10 11.06l1.72 1.72a.75.75 0 101.06-1.06L11.06 10l1.72-1.72a.75.75 0 00-1.06-1.06L10 8.94 8.28 7.22z" clip-rule="evenodd" />
    </svg>
    <span>{{ error }}</span>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <div class="loading-spinner"></div>
    <p class="loading-text">Loading orders...</p>
  </div>

  <!-- Orders Table -->
  <div class="orders-content" *ngIf="!loading">
    <div class="orders-card">
      <div class="card-header">
        <h2 class="card-title">Order History</h2>
        <p class="card-subtitle">All orders for this customer</p>
      </div>

      <!-- Empty State -->
      <div *ngIf="orders.length === 0" class="empty-state">
        <div class="empty-state-icon">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
          </svg>
        </div>
        <h3 class="empty-state-title">No orders yet</h3>
        <p class="empty-state-text">This customer hasn't placed any orders.</p>
      </div>

      <!-- Orders Table -->
      <div *ngIf="orders.length > 0" class="table-container">
        <table class="orders-table">
          <thead>
            <tr>
              <th>Order ID</th>
              <th>Amount</th>
              <th>Date & Time</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let order of orders" class="order-row">
              <td class="order-id">
                <span class="id-badge">#{{ order.id }}</span>
              </td>
              <td class="order-amount">
                <span class="amount-value">${{ order.amount.toFixed(2) }}</span>
              </td>
              <td class="order-date">
                <div class="date-info">
                  <span class="date">{{ order.createdAt | date: 'MMM d, y' }}</span>
                  <span class="time">{{ order.createdAt | date: 'h:mm a' }}</span>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Pagination -->
      <div *ngIf="totalPages > 1" class="pagination">
        <button 
          class="pagination-btn" 
          [disabled]="currentPage === 1"
          (click)="previousPage()">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M12.79 5.23a.75.75 0 01-.02 1.06L8.832 10l3.938 3.71a.75.75 0 11-1.04 1.08l-4.5-4.25a.75.75 0 010-1.08l4.5-4.25a.75.75 0 011.06.02z" clip-rule="evenodd" />
          </svg>
          Previous
        </button>

        <div class="pagination-pages">
          <button 
            *ngFor="let page of paginationPages"
            class="pagination-page"
            [class.active]="page === currentPage"
            (click)="goToPage(page)">
            {{ page }}
          </button>
        </div>

        <button 
          class="pagination-btn" 
          [disabled]="currentPage === totalPages"
          (click)="nextPage()">
          Next
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z" clip-rule="evenodd" />
          </svg>
        </button>
      </div>

      <!-- Pagination Info -->
      <div class="pagination-info" *ngIf="orders.length > 0">
        <p>Showing {{ (currentPage - 1) * pageSize + 1 }} to {{ Math.min(currentPage * pageSize, totalCount) }} of {{ totalCount }} orders</p>
      </div>
    </div>
  </div>
</div>
